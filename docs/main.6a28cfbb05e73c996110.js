!function(e){function t(t){for(var n,s,i=t[0],l=t[1],c=t[2],u=0,f=[];u<i.length;u++)s=i[u],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&f.push(a[s][0]),a[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(d&&d(t);f.length;)f.shift()();return o.push.apply(o,c||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,i=1;i<r.length;i++){var l=r[i];0!==a[l]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={0:0},o=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var i=window.webpackJsonp=window.webpackJsonp||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var d=l;o.push(["/7QA",1]),r()}({"/7QA":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("DtyJ"),a=r("ahDk"),o=r("CO/c"),s=r("6luj"),i=localStorage.getItem("causal-flow-text"),l=document.getElementById("diagram-text");l.value=i;const c=n.fromEvent(l,"input").pipe(a.map(e=>e.target),a.map(e=>e.value),a.debounceTime(375)),d=c.pipe(a.startWith(i),a.map(o.toSizedNodeVertexPairs));c.subscribe(e=>{localStorage.setItem("causal-flow-text",e)}),s.init("#outlet",d)},"6luj":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const n=r("VphZ"),a=r("ahDk");t.init=(e,t)=>{const r=n.select(e),o=r.append("g").attr("class","lines");let s;t.pipe(a.map(e=>{const t=e.nodes,r=t.map((e,t)=>({index:t,id:e}));return{sizedNodes:t,nodes:r,links:e.links.map(e=>({id:e.source,source:e.source,target:e.target,direction:e.edge}))}})).subscribe(e=>{const t=n.forceSimulation(e.nodes).force("link",n.forceLink(e.links).id(t=>e.sizedNodes[t.index].name||"unknown")).force("charge",n.forceManyBody()).force("center",n.forceCenter(450,250)).force("collision",n.forceCollide().radius(t=>e.sizedNodes[t.index].radius+80)),a=o.selectAll(".line").data(e.links).join("line").attr("stroke-opacity",1).attr("class",e=>e.direction+" line").attr("data-link",e=>{const t=e;return JSON.stringify(t)}).attr("marker-center","url(#triangle)").attr("stroke-width",2).attr("stroke-dasharray","5 5").attr("stroke-dashoffset",5).attr("stroke",e=>"increases"===e.direction?"green":"red").call(()=>{s||(s=n.interval(()=>{console.log("in interval"),r.selectAll(".line").each((function(e){n.select(this).attr("stroke-dasharray","5 5").attr("stroke-dashoffset",5).transition().ease(n.easeCircle).attr("stroke-dashoffset",0)}))},300))}),i=r.selectAll(".node").data(e.nodes).join("g").attr("class","node").call(()=>(e=>n.drag().on("start",t=>{n.event.active||e.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y}).on("drag",e=>{e.fx=n.event.x,e.fy=n.event.y}).on("end",t=>{n.event.active||e.alphaTarget(0),t.fx=null,t.fy=null}))(t));i.selectAll("circle").remove(),i.selectAll("text").remove(),i.append("circle").attr("stroke","black").attr("stroke-width",1.5).attr("r",t=>(e=>e.radius+60)(e.sizedNodes[t.index])).attr("fill","white"),i.append("text").attr("text-anchor","middle").attr("alignment-baseline","central").text(t=>e.sizedNodes[t.index].name),t.on("tick",()=>{a.attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y),i.attr("transform",e=>`translate(${e.x}, ${e.y})`)})})}},"CO/c":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toNodeVertexPairs=t.toSizedNodeVertexPairs=void 0;const n=e=>"+"===e||"-"===e,a=e=>{const t={edge:"",start:"",end:""};let r=!1,a=!0;return e.split("").forEach(e=>{(e=>'"'===e)(e)?r=!r:((e,t)=>!e&&n(t))(r,e)?(t.edge=e,a=!1):a?t.start+=e:t.end+=e}),(e=>""!==e.start&&""!==e.end&&n(e.edge))(t)?{edge:"+"===t.edge?"increases":"decreases",source:t.start.trim(),target:t.end.trim()}:null};t.toSizedNodeVertexPairs=e=>{const r=t.toNodeVertexPairs(e),n=r.reduce((e,t)=>(e[t.source]||(e[t.source]={name:t.source,radius:0}),e[t.target]||(e[t.target]={name:t.target,radius:0}),"increases"===t.edge&&(e[t.target].radius+=5),"decreases"===t.edge&&(e[t.target].radius-=5),e),{});return{nodes:Object.values(n),links:r}},t.toNodeVertexPairs=e=>e?e.split("\n").map(a).filter(e=>null!==e):[]}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9jaGFydC9jaGFydGluZy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvcGFyc2UtZGVzY3JpcHRpb24vcGFyc2UudHMiXSwibmFtZXMiOlsid2VicGFja0pzb25wQ2FsbGJhY2siLCJkYXRhIiwibW9kdWxlSWQiLCJjaHVua0lkIiwiY2h1bmtJZHMiLCJtb3JlTW9kdWxlcyIsImV4ZWN1dGVNb2R1bGVzIiwiaSIsInJlc29sdmVzIiwibGVuZ3RoIiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaW5zdGFsbGVkQ2h1bmtzIiwicHVzaCIsIm1vZHVsZXMiLCJwYXJlbnRKc29ucEZ1bmN0aW9uIiwic2hpZnQiLCJkZWZlcnJlZE1vZHVsZXMiLCJhcHBseSIsImNoZWNrRGVmZXJyZWRNb2R1bGVzIiwicmVzdWx0IiwiZGVmZXJyZWRNb2R1bGUiLCJmdWxmaWxsZWQiLCJqIiwiZGVwSWQiLCJzcGxpY2UiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwicyIsImluc3RhbGxlZE1vZHVsZXMiLCIwIiwiZXhwb3J0cyIsIm1vZHVsZSIsImwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicCIsImpzb25wQXJyYXkiLCJ3aW5kb3ciLCJvbGRKc29ucEZ1bmN0aW9uIiwic2xpY2UiLCJ0ZXh0T25Mb2FkIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImRpYWdyYW1UZXh0QXJlYSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ0ZXh0Q2hhbmdlcyQiLCJmcm9tRXZlbnQiLCJwaXBlIiwibWFwIiwiZSIsInRhcmdldCIsImRlYm91bmNlVGltZSIsImRpYWdyYW1EZXNjcmlwdGlvbiQiLCJzdGFydFdpdGgiLCJ0b1NpemVkTm9kZVZlcnRleFBhaXJzIiwic3Vic2NyaWJlIiwidGV4dCIsInNldEl0ZW0iLCJpbml0IiwiY29udGFpbmVyIiwiZ3JhcGhEYXRhJCIsInN2ZyIsImQzIiwic2VsZWN0IiwibGluZXNHcm91cCIsImFwcGVuZCIsImF0dHIiLCJsaW5lQW5pbWF0aW9uIiwieCIsInNpemVkTm9kZXMiLCJub2RlcyIsInYiLCJpbmRleCIsImlkIiwibGlua3MiLCJzb3VyY2UiLCJkaXJlY3Rpb24iLCJlZGdlIiwic2ltdWxhdGlvbiIsImZvcmNlU2ltdWxhdGlvbiIsImZvcmNlIiwiZm9yY2VMaW5rIiwiZm9yY2VNYW55Qm9keSIsImZvcmNlQ2VudGVyIiwiZm9yY2VDb2xsaWRlIiwicmFkaXVzIiwibGluayIsInNlbGVjdEFsbCIsImpvaW4iLCJKU09OIiwic3RyaW5naWZ5IiwiaW50ZXJ2YWwiLCJjb25zb2xlIiwibG9nIiwiZWFjaCIsInRoaXMiLCJ0cmFuc2l0aW9uIiwiZWFzZSIsImVhc2VDaXJjbGUiLCJub2RlIiwiZHJhZyIsIm9uIiwiZXZlbnQiLCJhY3RpdmUiLCJhbHBoYVRhcmdldCIsInJlc3RhcnQiLCJmeCIsImZ5IiwieSIsInJlbW92ZSIsInNpemVkTm9kZSIsImNhbGN1bGF0ZVJhZGl1cyIsImlzTGlua2luZ0NoYXIiLCJwYXJzZUxpbmUiLCJwb3RlbnRpYWwiLCJzdGFydCIsImVuZCIsImluUXVvdGVkU3RyaW5nIiwicmVhZGluZ1N0YXJ0Iiwic3BsaXQiLCJmb3JFYWNoIiwiaXNXb3JkQm91bmRhcnkiLCJmaW5pc2hlZFJlYWRpbmdTdGFydCIsImlzVmFsaWRQYWlyIiwidHJpbSIsInBhaXJzIiwidG9Ob2RlVmVydGV4UGFpcnMiLCJnYXRoZXJlZE5vZGVzIiwicmVkdWNlIiwiYWNjIiwiY3VyciIsInZh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QUFnQkYsRUFBTUcsT0FBa0MsQ0FBQ0MsRUFBS0MsS0FDM0RELEVBQUlDLEVBQUt2RCxVQUNWc0QsRUFBSUMsRUFBS3ZELFFBQVUsQ0FBRTdELEtBQU1vSCxFQUFLdkQsT0FBUVUsT0FBUSxJQUUvQzRDLEVBQUlDLEVBQUtoRixVQUNWK0UsRUFBSUMsRUFBS2hGLFFBQVUsQ0FBRXBDLEtBQU1vSCxFQUFLaEYsT0FBUW1DLE9BQVEsSUFFbEMsY0FBZDZDLEVBQUtyRCxPQUNMb0QsRUFBSUMsRUFBS2hGLFFBQVFtQyxRQUFVLEdBRWIsY0FBZDZDLEVBQUtyRCxPQUNMb0QsRUFBSUMsRUFBS2hGLFFBQVFtQyxRQUFVLEdBRXhCNEMsR0FDUixJQUNILE1BQU8sQ0FDSDNELE1BQU9wRixPQUFPaUosT0FBT0osR0FDckJyRCxNQUFPbUQsSUFJRixFQUFBQyxrQkFBcUJ6SCxHQUM5QkEsRUFBSUEsRUFBRWtILE1BQU0sTUFDUHZFLElBQUlpRSxHQUNKbUIsT0FBT2hFLEdBQVcsT0FBTkEsR0FBYyIsImZpbGUiOiJtYWluLjZhMjhjZmJiMDVlNzNjOTk2MTEwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG4gXHRmdW5jdGlvbiB3ZWJwYWNrSnNvbnBDYWxsYmFjayhkYXRhKSB7XG4gXHRcdHZhciBjaHVua0lkcyA9IGRhdGFbMF07XG4gXHRcdHZhciBtb3JlTW9kdWxlcyA9IGRhdGFbMV07XG4gXHRcdHZhciBleGVjdXRlTW9kdWxlcyA9IGRhdGFbMl07XG5cbiBcdFx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG4gXHRcdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuIFx0XHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwLCByZXNvbHZlcyA9IFtdO1xuIFx0XHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcbiBcdFx0XHRpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSAmJiBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcbiBcdFx0XHRcdHJlc29sdmVzLnB1c2goaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKTtcbiBcdFx0XHR9XG4gXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcbiBcdFx0fVxuIFx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcbiBcdFx0XHRpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuIFx0XHRcdFx0bW9kdWxlc1ttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG4gXHRcdFx0fVxuIFx0XHR9XG4gXHRcdGlmKHBhcmVudEpzb25wRnVuY3Rpb24pIHBhcmVudEpzb25wRnVuY3Rpb24oZGF0YSk7XG5cbiBcdFx0d2hpbGUocmVzb2x2ZXMubGVuZ3RoKSB7XG4gXHRcdFx0cmVzb2x2ZXMuc2hpZnQoKSgpO1xuIFx0XHR9XG5cbiBcdFx0Ly8gYWRkIGVudHJ5IG1vZHVsZXMgZnJvbSBsb2FkZWQgY2h1bmsgdG8gZGVmZXJyZWQgbGlzdFxuIFx0XHRkZWZlcnJlZE1vZHVsZXMucHVzaC5hcHBseShkZWZlcnJlZE1vZHVsZXMsIGV4ZWN1dGVNb2R1bGVzIHx8IFtdKTtcblxuIFx0XHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIGFsbCBjaHVua3MgcmVhZHlcbiBcdFx0cmV0dXJuIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCk7XG4gXHR9O1xuIFx0ZnVuY3Rpb24gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKSB7XG4gXHRcdHZhciByZXN1bHQ7XG4gXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZE1vZHVsZXMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHR2YXIgZGVmZXJyZWRNb2R1bGUgPSBkZWZlcnJlZE1vZHVsZXNbaV07XG4gXHRcdFx0dmFyIGZ1bGZpbGxlZCA9IHRydWU7XG4gXHRcdFx0Zm9yKHZhciBqID0gMTsgaiA8IGRlZmVycmVkTW9kdWxlLmxlbmd0aDsgaisrKSB7XG4gXHRcdFx0XHR2YXIgZGVwSWQgPSBkZWZlcnJlZE1vZHVsZVtqXTtcbiBcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rc1tkZXBJZF0gIT09IDApIGZ1bGZpbGxlZCA9IGZhbHNlO1xuIFx0XHRcdH1cbiBcdFx0XHRpZihmdWxmaWxsZWQpIHtcbiBcdFx0XHRcdGRlZmVycmVkTW9kdWxlcy5zcGxpY2UoaS0tLCAxKTtcbiBcdFx0XHRcdHJlc3VsdCA9IF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gZGVmZXJyZWRNb2R1bGVbMF0pO1xuIFx0XHRcdH1cbiBcdFx0fVxuXG4gXHRcdHJldHVybiByZXN1bHQ7XG4gXHR9XG5cbiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4gXHQvLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbiBcdC8vIFByb21pc2UgPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG4gXHR2YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuIFx0XHQwOiAwXG4gXHR9O1xuXG4gXHR2YXIgZGVmZXJyZWRNb2R1bGVzID0gW107XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdHZhciBqc29ucEFycmF5ID0gd2luZG93W1wid2VicGFja0pzb25wXCJdID0gd2luZG93W1wid2VicGFja0pzb25wXCJdIHx8IFtdO1xuIFx0dmFyIG9sZEpzb25wRnVuY3Rpb24gPSBqc29ucEFycmF5LnB1c2guYmluZChqc29ucEFycmF5KTtcbiBcdGpzb25wQXJyYXkucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrO1xuIFx0anNvbnBBcnJheSA9IGpzb25wQXJyYXkuc2xpY2UoKTtcbiBcdGZvcih2YXIgaSA9IDA7IGkgPCBqc29ucEFycmF5Lmxlbmd0aDsgaSsrKSB3ZWJwYWNrSnNvbnBDYWxsYmFjayhqc29ucEFycmF5W2ldKTtcbiBcdHZhciBwYXJlbnRKc29ucEZ1bmN0aW9uID0gb2xkSnNvbnBGdW5jdGlvbjtcblxuXG4gXHQvLyBhZGQgZW50cnkgbW9kdWxlIHRvIGRlZmVycmVkIGxpc3RcbiBcdGRlZmVycmVkTW9kdWxlcy5wdXNoKFtcIi83UUFcIiwxXSk7XG4gXHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIHJlYWR5XG4gXHRyZXR1cm4gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKTtcbiIsImltcG9ydCB7ZnJvbUV2ZW50fSBmcm9tICdyeGpzJztcbmltcG9ydCB7ZGVib3VuY2VUaW1lLCBtYXAsIHN0YXJ0V2l0aH0gZnJvbSBcInJ4anMvb3BlcmF0b3JzXCI7XG5pbXBvcnQge3RvU2l6ZWROb2RlVmVydGV4UGFpcnN9IGZyb20gXCIuL3BhcnNlLWRlc2NyaXB0aW9uL3BhcnNlXCI7XG5pbXBvcnQge2luaXR9IGZyb20gXCIuL2NoYXJ0L2NoYXJ0aW5nXCI7XG5cbmNvbnN0IHRleHRPbkxvYWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2F1c2FsLWZsb3ctdGV4dCcpXG5cbmNvbnN0IGRpYWdyYW1UZXh0QXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaWFncmFtLXRleHQnKTtcbihkaWFncmFtVGV4dEFyZWEgYXMgSFRNTFRleHRBcmVhRWxlbWVudCkudmFsdWUgPSB0ZXh0T25Mb2FkXG5cbmNvbnN0IHRleHRDaGFuZ2VzJCA9IGZyb21FdmVudDxJbnB1dEV2ZW50PihkaWFncmFtVGV4dEFyZWEsICdpbnB1dCcpXG4ucGlwZShcbiAgICBtYXAoZSA9PiAoZS50YXJnZXQgYXMgSFRNTFRleHRBcmVhRWxlbWVudCkpLFxuICAgIG1hcChlID0+IGUudmFsdWUpLFxuICAgIGRlYm91bmNlVGltZSgzNzUpXG4pXG5cbmNvbnN0IGRpYWdyYW1EZXNjcmlwdGlvbiQgPSB0ZXh0Q2hhbmdlcyQucGlwZShcbiAgICBzdGFydFdpdGgodGV4dE9uTG9hZCksXG4gICAgbWFwKHRvU2l6ZWROb2RlVmVydGV4UGFpcnMpXG4pXG50ZXh0Q2hhbmdlcyQuc3Vic2NyaWJlKHRleHQgPT4ge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYXVzYWwtZmxvdy10ZXh0JywgdGV4dClcbn0pXG5cbmluaXQoJyNvdXRsZXQnLCBkaWFncmFtRGVzY3JpcHRpb24kKSIsImltcG9ydCAqIGFzIGQzIGZyb20gXCJkM1wiO1xuaW1wb3J0IHtEcmFnQmVoYXZpb3IsIERyYWdnZWRFbGVtZW50QmFzZVR5cGUsIFNpbXVsYXRpb25MaW5rRGF0dW0sIFNpbXVsYXRpb25Ob2RlRGF0dW19IGZyb20gXCJkM1wiO1xuaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tIFwicnhqc1wiO1xuaW1wb3J0IHtTaXplZE5vZGUsIFNpemVkUGFpcnN9IGZyb20gXCIuLi9wYXJzZS1kZXNjcmlwdGlvbi9wYXJzZVwiO1xuaW1wb3J0IHtTaW11bGF0aW9ufSBmcm9tIFwiZDMtZm9yY2VcIjtcbmltcG9ydCB7bWFwfSBmcm9tIFwicnhqcy9vcGVyYXRvcnNcIjtcblxuaW50ZXJmYWNlIEtleWVkIHtcbiAgICBpZDogU2l6ZWROb2RlXG59XG5cbmludGVyZmFjZSBOb2RlIGV4dGVuZHMgU2ltdWxhdGlvbk5vZGVEYXR1bSB7XG59XG5cbmludGVyZmFjZSBMaW5rIGV4dGVuZHMgU2ltdWxhdGlvbkxpbmtEYXR1bTxOb2RlPiB7XG4gICAgZGlyZWN0aW9uOiBcImluY3JlYXNlc1wiIHwgXCJkZWNyZWFzZXNcIlxufVxuXG5jb25zdCBjYWxjdWxhdGVSYWRpdXMgPSAoc2l6ZWROb2RlOiBTaXplZE5vZGUpOiBudW1iZXIgPT4gc2l6ZWROb2RlLnJhZGl1cyArIDYwO1xuXG5jb25zdCBkcmFnID0gKHNpbXVsYXRpb246IFNpbXVsYXRpb248Tm9kZSwgTGluaz4pOiBEcmFnQmVoYXZpb3I8RHJhZ2dlZEVsZW1lbnRCYXNlVHlwZSwgdW5rbm93biwgdW5rbm93bj4gPT4ge1xuXG4gICAgY29uc3Qgb25EcmFnU3RhcnQgPSAoZDogTm9kZSkgPT4ge1xuICAgICAgICBpZiAoIWQzLmV2ZW50LmFjdGl2ZSkgc2ltdWxhdGlvbi5hbHBoYVRhcmdldCgwLjMpLnJlc3RhcnQoKTtcbiAgICAgICAgZC5meCA9IGQueDtcbiAgICAgICAgZC5meSA9IGQueTtcbiAgICB9O1xuXG4gICAgY29uc3Qgb25EcmFnID0gKGQ6IE5vZGUpID0+IHtcbiAgICAgICAgZC5meCA9IGQzLmV2ZW50Lng7XG4gICAgICAgIGQuZnkgPSBkMy5ldmVudC55O1xuICAgIH07XG5cbiAgICBjb25zdCBvbkRyYWdFbmQgPSAoZDogTm9kZSkgPT4ge1xuICAgICAgICBpZiAoIWQzLmV2ZW50LmFjdGl2ZSkgc2ltdWxhdGlvbi5hbHBoYVRhcmdldCgwKTtcbiAgICAgICAgZC5meCA9IG51bGw7XG4gICAgICAgIGQuZnkgPSBudWxsO1xuICAgIH07XG5cbiAgICBjb25zdCBkcmFnID0gZDMuZHJhZygpIGFzIERyYWdCZWhhdmlvcjxEcmFnZ2VkRWxlbWVudEJhc2VUeXBlLCB1bmtub3duLCB1bmtub3duPjtcbiAgICByZXR1cm4gZHJhZ1xuICAgICAgICAub24oXCJzdGFydFwiLCBvbkRyYWdTdGFydClcbiAgICAgICAgLm9uKFwiZHJhZ1wiLCBvbkRyYWcpXG4gICAgICAgIC5vbihcImVuZFwiLCBvbkRyYWdFbmQpO1xufVxuXG5leHBvcnQgY29uc3QgaW5pdCA9IChjb250YWluZXI6IHN0cmluZywgZ3JhcGhEYXRhJDogT2JzZXJ2YWJsZTxTaXplZFBhaXJzPikgPT4ge1xuICAgIGNvbnN0IHN2ZyA9IGQzLnNlbGVjdChjb250YWluZXIpO1xuXG4gICAgY29uc3QgbGluZXNHcm91cCA9IHN2Zy5hcHBlbmQoJ2cnKS5hdHRyKCdjbGFzcycsICdsaW5lcycpXG5cbiAgICBsZXQgbGluZUFuaW1hdGlvbjogZDMuVGltZXI7XG5cbiAgICBncmFwaERhdGEkXG4gICAgICAgIC5waXBlKFxuICAgICAgICAgICAgbWFwKHggPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNpemVkTm9kZXMgPSB4Lm5vZGVzXG5cbiAgICAgICAgICAgICAgICBjb25zdCBub2RlczogKEtleWVkICYgTm9kZSlbXSA9IHNpemVkTm9kZXMubWFwKCh2LCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7aW5kZXg6IGksIGlkOiB2fVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rczogTGlua1tdID0geC5saW5rcy5tYXAodiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7aWQ6IHYuc291cmNlLCBzb3VyY2U6IHYuc291cmNlLCB0YXJnZXQ6IHYudGFyZ2V0LCBkaXJlY3Rpb246IHYuZWRnZX1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzaXplZE5vZGVzLFxuICAgICAgICAgICAgICAgICAgICBub2RlcyxcbiAgICAgICAgICAgICAgICAgICAgbGlua3NcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICAgIC5zdWJzY3JpYmUoZSA9PiB7XG5cbiAgICAgICAgICAgIGNvbnN0IHNpbXVsYXRpb246IFNpbXVsYXRpb248Tm9kZSwgTGluaz4gPSBkMy5mb3JjZVNpbXVsYXRpb24oZS5ub2RlcylcbiAgICAgICAgICAgICAgICAuZm9yY2UoXCJsaW5rXCIsIGQzLmZvcmNlTGluayhlLmxpbmtzKS5pZChkID0+IGUuc2l6ZWROb2Rlc1tkLmluZGV4XS5uYW1lIHx8IFwidW5rbm93blwiKSlcbiAgICAgICAgICAgICAgICAuZm9yY2UoXCJjaGFyZ2VcIiwgZDMuZm9yY2VNYW55Qm9keSgpKVxuICAgICAgICAgICAgICAgIC5mb3JjZShcImNlbnRlclwiLCBkMy5mb3JjZUNlbnRlcig5MDAgLyAyLCA1MDAgLyAyKSlcbiAgICAgICAgICAgICAgICAuZm9yY2UoJ2NvbGxpc2lvbicsIGQzLmZvcmNlQ29sbGlkZSgpLnJhZGl1cyhkID0+IGUuc2l6ZWROb2Rlc1tkLmluZGV4XS5yYWRpdXMgKyA4MCkpO1xuXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gbGluZXNHcm91cFxuICAgICAgICAgICAgICAgIC5zZWxlY3RBbGwoXCIubGluZVwiKVxuICAgICAgICAgICAgICAgIC5kYXRhKGUubGlua3MpXG4gICAgICAgICAgICAgICAgLmpvaW4oXCJsaW5lXCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJzdHJva2Utb3BhY2l0eVwiLCAxKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkIGFzIExpbmtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGAke2xpbmsuZGlyZWN0aW9ufSBsaW5lYFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJkYXRhLWxpbmtcIiwgZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkIGFzIExpbmtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGxpbmspXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuYXR0cihcIm1hcmtlci1jZW50ZXJcIiwgXCJ1cmwoI3RyaWFuZ2xlKVwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJzdHJva2UtZGFzaGFycmF5XCIsIFwiNSA1XCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJzdHJva2UtZGFzaG9mZnNldFwiLCA1KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIGQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gZCBhcyBMaW5rXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsaW5rLmRpcmVjdGlvbiA9PT0gXCJpbmNyZWFzZXNcIiA/IFwiZ3JlZW5cIiA6IFwicmVkXCJcbiAgICAgICAgICAgICAgICB9KS5jYWxsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYoIWxpbmVBbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVBbmltYXRpb24gPSBkMy5pbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2luIGludGVydmFsJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdmcuc2VsZWN0QWxsKFwiLmxpbmVcIikuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlLWRhc2hhcnJheVwiLCBcIjUgNVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJzdHJva2UtZGFzaG9mZnNldFwiLCA1KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVhc2UoZDMuZWFzZUNpcmNsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlLWRhc2hvZmZzZXRcIiwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBub2RlID0gc3ZnXG4gICAgICAgICAgICAgICAgLnNlbGVjdEFsbChcIi5ub2RlXCIpXG4gICAgICAgICAgICAgICAgLmRhdGEoZS5ub2RlcylcbiAgICAgICAgICAgICAgICAuam9pbihcImdcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwibm9kZVwiKVxuICAgICAgICAgICAgICAgIC5jYWxsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRyYWcoc2ltdWxhdGlvbilcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbm9kZS5zZWxlY3RBbGwoXCJjaXJjbGVcIikucmVtb3ZlKClcbiAgICAgICAgICAgIG5vZGUuc2VsZWN0QWxsKFwidGV4dFwiKS5yZW1vdmUoKVxuXG4gICAgICAgICAgICBub2RlLmFwcGVuZChcImNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwiYmxhY2tcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAxLjUpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJyXCIsIGQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzaXplZE5vZGUgPSBlLnNpemVkTm9kZXNbZC5pbmRleF07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxjdWxhdGVSYWRpdXMoc2l6ZWROb2RlKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiZmlsbFwiLCBcIndoaXRlXCIpXG5cbiAgICAgICAgICAgIC8qIENyZWF0ZSB0aGUgdGV4dCBmb3IgZWFjaCBibG9jayAqL1xuICAgICAgICAgICAgbm9kZS5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiYWxpZ25tZW50LWJhc2VsaW5lXCIsIFwiY2VudHJhbFwiKVxuICAgICAgICAgICAgICAgIC50ZXh0KChkOiBOb2RlKSA9PiBlLnNpemVkTm9kZXNbZC5pbmRleF0ubmFtZSlcblxuICAgICAgICAgICAgc2ltdWxhdGlvbi5vbihcInRpY2tcIiwgKCkgPT4ge1xuXG4gICAgICAgICAgICAgICAgbGlua1xuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIngxXCIsIChkOiBMaW5rKSA9PiAoZC5zb3VyY2UgYXMgTm9kZSkueClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ5MVwiLCAoZDogTGluaykgPT4gKGQuc291cmNlIGFzIE5vZGUpLnkpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieDJcIiwgKGQ6IExpbmspID0+IChkLnRhcmdldCBhcyBOb2RlKS54KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInkyXCIsIChkOiBMaW5rKSA9PiAoZC50YXJnZXQgYXMgTm9kZSkueSk7XG5cbiAgICAgICAgICAgICAgICBub2RlXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGQgPT4gYHRyYW5zbGF0ZSgke2QueH0sICR7ZC55fSlgKVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSlcbn1cblxuIiwiXG5jb25zdCBpc0xpbmtpbmdDaGFyID0gKHg6IHN0cmluZykgPT4geCA9PT0gJysnIHx8IHggPT09ICctJztcblxuY29uc3QgZmluaXNoZWRSZWFkaW5nU3RhcnQgPSAoaW5RdW90ZWRTdHJpbmc6IGJvb2xlYW4sIHg6IHN0cmluZykgPT4gIWluUXVvdGVkU3RyaW5nICYmIGlzTGlua2luZ0NoYXIoeCk7XG5cbmNvbnN0IGlzV29yZEJvdW5kYXJ5ID0gKHg6IHN0cmluZykgPT4geCA9PT0gXCJcXFwiXCI7XG5cbmNvbnN0IGlzVmFsaWRQYWlyID0gKHBvdGVudGlhbDogeyBlZGdlOiBzdHJpbmc7IHN0YXJ0OiBzdHJpbmc7IGVuZDogc3RyaW5nIH0pID0+XG4gICAgcG90ZW50aWFsLnN0YXJ0ICE9PSBcIlwiICYmIHBvdGVudGlhbC5lbmQgIT09IFwiXCIgJiYgaXNMaW5raW5nQ2hhcihwb3RlbnRpYWwuZWRnZSk7XG5cbmNvbnN0IHBhcnNlTGluZSA9IChzOiBzdHJpbmcpOiBQYWlyIHwgbnVsbCA9PiB7XG4gICAgY29uc3QgcG90ZW50aWFsID0ge1xuICAgICAgICBlZGdlOiBcIlwiLFxuICAgICAgICBzdGFydDogXCJcIixcbiAgICAgICAgZW5kOiBcIlwiXG4gICAgfVxuXG4gICAgbGV0IGluUXVvdGVkU3RyaW5nID0gZmFsc2VcbiAgICBsZXQgcmVhZGluZ1N0YXJ0ID0gdHJ1ZVxuXG4gICAgcy5zcGxpdCgnJylcbiAgICAgICAgLmZvckVhY2goeCA9PiB7XG4gICAgICAgICAgICBpZiAoaXNXb3JkQm91bmRhcnkoeCkpIHtcbiAgICAgICAgICAgICAgICBpblF1b3RlZFN0cmluZyA9ICFpblF1b3RlZFN0cmluZ1xuICAgICAgICAgICAgfSBlbHNlIGlmIChmaW5pc2hlZFJlYWRpbmdTdGFydChpblF1b3RlZFN0cmluZywgeCkpIHtcbiAgICAgICAgICAgICAgICBwb3RlbnRpYWwuZWRnZSA9IHhcbiAgICAgICAgICAgICAgICByZWFkaW5nU3RhcnQgPSBmYWxzZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAocmVhZGluZ1N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbC5zdGFydCArPSB4XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG90ZW50aWFsLmVuZCArPSB4XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgcmV0dXJuIGlzVmFsaWRQYWlyKHBvdGVudGlhbCkgPyB7XG4gICAgICAgIGVkZ2U6IHBvdGVudGlhbC5lZGdlID09PSBcIitcIiA/IFwiaW5jcmVhc2VzXCIgOiBcImRlY3JlYXNlc1wiLFxuICAgICAgICBzb3VyY2U6IHBvdGVudGlhbC5zdGFydC50cmltKCksXG4gICAgICAgIHRhcmdldDogcG90ZW50aWFsLmVuZC50cmltKClcbiAgICB9IDogbnVsbFxufTtcblxuZXhwb3J0IGNvbnN0IHRvU2l6ZWROb2RlVmVydGV4UGFpcnMgPSAoczogc3RyaW5nKTogU2l6ZWRQYWlycyA9PiB7XG4gICAgY29uc3QgcGFpcnMgPSB0b05vZGVWZXJ0ZXhQYWlycyhzKVxuXG4gICAgY29uc3QgZ2F0aGVyZWROb2RlcyA9IHBhaXJzLnJlZHVjZTx7W2lkOiBzdHJpbmddOiBTaXplZE5vZGV9PigoYWNjLCBjdXJyKSA9PiB7XG4gICAgICAgIGlmICghYWNjW2N1cnIuc291cmNlXSkge1xuICAgICAgICAgICAgYWNjW2N1cnIuc291cmNlXSA9IHsgbmFtZTogY3Vyci5zb3VyY2UsIHJhZGl1czogMCB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFhY2NbY3Vyci50YXJnZXRdKSB7XG4gICAgICAgICAgICBhY2NbY3Vyci50YXJnZXRdID0geyBuYW1lOiBjdXJyLnRhcmdldCwgcmFkaXVzOiAwIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY3Vyci5lZGdlID09PSBcImluY3JlYXNlc1wiKSB7XG4gICAgICAgICAgICBhY2NbY3Vyci50YXJnZXRdLnJhZGl1cyArPSA1XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGN1cnIuZWRnZSA9PT0gXCJkZWNyZWFzZXNcIikge1xuICAgICAgICAgICAgYWNjW2N1cnIudGFyZ2V0XS5yYWRpdXMgLT0gNVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY2NcbiAgICB9LCB7fSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbm9kZXM6IE9iamVjdC52YWx1ZXMoZ2F0aGVyZWROb2RlcyksXG4gICAgICAgIGxpbmtzOiBwYWlyc1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IHRvTm9kZVZlcnRleFBhaXJzID0gKHM6IHN0cmluZyk6IEFycmF5PFBhaXI+ID0+XG4gICAgcyA/IHMuc3BsaXQoXCJcXG5cIilcbiAgICAgICAgLm1hcChwYXJzZUxpbmUpXG4gICAgICAgIC5maWx0ZXIoeCA9PiB4ICE9PSBudWxsKSA6IFtdXG5cbmV4cG9ydCBpbnRlcmZhY2UgU2l6ZWRQYWlycyB7XG4gICAgbm9kZXM6IFNpemVkTm9kZVtdLFxuICAgIGxpbmtzOiBQYWlyW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTaXplZE5vZGUge1xuICAgIG5hbWU6IHN0cmluZ1xuICAgIHJhZGl1czogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFpciB7XG4gICAgZWRnZTogXCJpbmNyZWFzZXNcIiB8IFwiZGVjcmVhc2VzXCIsXG4gICAgc291cmNlOiBzdHJpbmdcbiAgICB0YXJnZXQ6IHN0cmluZ1xufSJdLCJzb3VyY2VSb290IjoiIn0=